<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商品分期正式申請表</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        :root { --p: #1a508b; --s: #28a745; --bg: #f4f7f9; }
        body { font-family: "PingFang TC", sans-serif; background-color: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--p); border-bottom: 2px solid var(--p); padding-bottom: 10px; }
        .sec { background: #eef2f7; color: var(--p); padding: 10px; border-left: 5px solid var(--p); font-weight: bold; margin-top: 25px; border-radius: 4px; }
        .g { margin-top: 15px; }
        label { display: block; font-size: 14px; font-weight: bold; margin-bottom: 6px; color: #444; }
        label span { color: red; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; background: white; }
        .btn { background: var(--s); color: white; width: 100%; padding: 20px; border: none; border-radius: 12px; font-size: 18px; font-weight: bold; margin-top: 40px; cursor: pointer; }
        .btn:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="container">
    <h2>商品分期正式申請表單</h2>

    <div class="sec">一、個人基本資料</div>
    <div class="g"><label>全名<span>*</span></label><input type="text" id="v1" placeholder="例：馬俊祥"></div>
    <div class="g"><label>LINE ID<span>*</span></label><input type="text" id="v2" placeholder="請填寫完整 ID"></div>
    <div class="g"><label>出生年月日<span>*</span></label><input type="text" id="v3" placeholder="例：82/11/1"></div>
    <div class="g"><label>身分證字號<span>*</span></label><input type="text" id="v4" placeholder="例：U121769299"></div>
    <div class="g"><label>最高學歷<span>*</span></label><input type="text" id="v5" placeholder="例：高中"></div>
    <div class="g"><label>手機號碼<span>*</span></label><input type="tel" id="v6" placeholder="例：0921729504"></div>
    <div class="g"><label>方便聯絡時間<span>*</span></label><input type="text" id="v7" placeholder="例：1200-1300"></div>
    <div class="g"><label>電信業者<span>*</span></label><input type="text" id="v8" placeholder="例：台灣大哥大"></div>
    <div class="g"><label>常用 Email<span>*</span></label><input type="email" id="v9" placeholder="例：service@example.com"></div>

    <div class="sec">二、居住狀況</div>
    <div class="g"><label>戶籍地址<span>*</span></label><input type="text" id="v10" placeholder="請填寫完整地址"></div>
    <div class="g"><label>戶籍電話<span>*</span></label><input type="text" id="v11" placeholder="無則填無"></div>
    <div class="g"><label>現居地址<span>*</span></label><input type="text" id="v12" placeholder="例：同戶籍地址"></div>
    <div class="g"><label>現居電話<span>*</span></label><input type="text" id="v13" placeholder="無則填無"></div>
    <div class="g"><label>現居地居住時間<span>*</span></label><input type="text" id="v14" placeholder="例：5年"></div>
    <div class="g">
        <label>居住持有狀況<span>*</span></label>
        <select id="v15">
            <option value="">請選擇</option>
            <option value="自有">自有</option>
            <option value="租賃">租賃</option>
            <option value="親友">親友</option>
            <option value="宿舍">宿舍</option>
        </select>
    </div>

    <div class="sec">三、工作資訊</div>
    <div class="g"><label>公司名稱<span>*</span></label><input type="text" id="v16" placeholder="例：○○實業有限公司"></div>
    <div class="g"><label>公司電話<span>*</span></label><input type="text" id="v17" placeholder="例：02-12345678"></div>
    <div class="g"><label>公司地址<span>*</span></label><input type="text" id="v18" placeholder="例：台北市...號"></div>
    <div class="g"><label>職稱<span>*</span></label><input type="text" id="v19" placeholder="例：作業員"></div>
    <div class="g"><label>月收入<span>*</span></label><input type="text" id="v20" placeholder="例：35000"></div>
    <div class="g"><label>年資<span>*</span></label><input type="text" id="v21" placeholder="例：1年2個月"></div>
    <div class="g"><label>有無勞保薪轉<span>*</span></label><input type="text" id="v22" placeholder="例：皆有 / 僅勞保"></div>

    <div class="sec">四、聯絡人資訊 (一)</div>
    <div class="g"><label>姓名<span>*</span></label><input type="text" id="v23" placeholder="例：王小明"></div>
    <div class="g"><label>關係<span>*</span></label><input type="text" id="v24" placeholder="例：兄弟"></div>
    <div class="g"><label>電話<span>*</span></label><input type="tel" id="v25" placeholder="例：0912345678"></div>
    <div class="g"><label>方便照會時間<span>*</span></label><input type="text" id="v26" placeholder="例：隨時"></div>

    <div class="sec">五、聯絡人資訊 (二)</div>
    <div class="g"><label>姓名<span>*</span></label><input type="text" id="v27" placeholder="例：李大華"></div>
    <div class="g"><label>關係<span>*</span></label><input type="text" id="v28" placeholder="例：朋友"></div>
    <div class="g"><label>電話<span>*</span></label><input type="tel" id="v29" placeholder="例：0987654321"></div>
    <div class="g"><label>方便照會時間<span>*</span></label><input type="text" id="v30" placeholder="例：下班後"></div>

    <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="liff.closeWindow()">

    <button id="submitBtn" class="btn" onclick="handleSubmit()">確認送出並開啟拍照</button>
</div>

<script>
    const LIFF_ID = "2008759894-DkxBFgJp"; 
    liff.init({ liffId: LIFF_ID }).then(() => { if (!liff.isLoggedIn()) liff.login(); });

    async function handleSubmit() {
        const btn = document.getElementById('submitBtn');
        const fields = [
            {id:'v1', n:'全名'}, {id:'v2', n:'LINE ID'}, {id:'v3', n:'生日'}, {id:'v4', n:'身分證'}, {id:'v5', n:'學歷'}, {id:'v6', n:'手機'}, 
            {id:'v7', n:'聯絡時間'}, {id:'v8', n:'電信'}, {id:'v9', n:'Email'}, {id:'v10', n:'戶籍地址'}, {id:'v11', n:'戶籍電話'}, 
            {id:'v12', n:'現居地址'}, {id:'v13', n:'現居電話'}, {id:'v14', n:'居住時間'}, {id:'v15', n:'產權'}, {id:'v16', n:'公司名稱'}, 
            {id:'v17', n:'公司電話'}, {id:'v18', n:'公司地址'}, {id:'v19', n:'職稱'}, {id:'v20', n:'月收入'}, {id:'v21', n:'年資'}, 
            {id:'v22', n:'勞保薪轉'}, {id:'v23', n:'聯1姓名'}, {id:'v24', n:'聯1關係'}, {id:'v25', n:'聯1電話'}, {id:'v26', n:'聯1照會'}, 
            {id:'v27', n:'聯2姓名'}, {id:'v28', n:'聯2關係'}, {id:'v29', n:'聯2電話'}, {id:'v30', n:'聯2照會'}
        ];

        // 檢查必填
        for (let f of fields) {
            const val = document.getElementById(f.id).value;
            if (!val) {
                alert("「" + f.n + "」尚未填寫！");
                document.getElementById(f.id).focus();
                return;
            }
        }

        btn.disabled = true;
        btn.innerText = "資料傳送中...";

        // 組合訊息
        let msg = "【新件正式申請單】\n";
        fields.forEach(f => {
            msg += `${f.n}：${document.getElementById(f.id).value}\n`;
        });
        msg += "\n⚠️ 請接著傳送身分證正反面照片！";

        try {
            // 先發送 LINE 訊息
            await liff.sendMessages([{ type: 'text', text: msg }]);
            
            // 訊息成功後，立刻彈出選單（拍照或相簿）
            document.getElementById('photoInput').click();

            // 變更按鈕提示
            btn.innerText = "請選取照片完成申請";
            
        } catch (error) {
            alert("傳送失敗，請確保在 LINE App 內開啟：" + error);
            btn.disabled = false;
            btn.innerText = "確認送出並開啟拍照";
        }
    }
</script>
</body>
</html>