<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³‡é‡‘é¡§å•-éŠæˆ²åŒ–ç”³è«‹ç³»çµ±</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        :root { --p: #1a508b; --s: #28a745; --bg: #f4f7f9; --gold: #ffd700; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        
        /* éŠæˆ²åŒ–é€²åº¦å„€è¡¨æ¿ */
        .rank-card { background: linear-gradient(135deg, #1a508b, #0d2a4a); color: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        .rank-header { display: flex; justify-content: space-between; align-items: center; }
        .rank-name { font-size: 22px; font-weight: bold; color: var(--gold); }
        .score-info { font-size: 14px; opacity: 0.9; }
        .progress-bg { background: rgba(255,255,255,0.2); height: 10px; border-radius: 5px; margin: 15px 0 5px; overflow: hidden; }
        .progress-bar { background: var(--gold); height: 100%; width: 0%; transition: width 1s; box-shadow: 0 0 10px var(--gold); }
        .rank-footer { font-size: 12px; display: flex; justify-content: space-between; }

        .sec { background: #eef2f7; color: var(--p); padding: 10px; border-left: 5px solid var(--p); font-weight: bold; margin-top: 25px; border-radius: 4px; }
        .g { margin-top: 15px; }
        label { display: block; font-size: 14px; font-weight: bold; margin-bottom: 6px; color: #444; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        
        .promo-box { background: #fff9e6; border: 1px dashed #d4a017; padding: 15px; border-radius: 10px; margin-top: 15px; font-size: 14px; line-height: 1.6; }
        .btn { background: var(--s); color: white; width: 100%; padding: 20px; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 30px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <div class="rank-card">
        <div class="rank-header">
            <div id="rankLabel" class="rank-name">è®€å–ä¸­...</div>
            <div class="score-info">ç©åˆ†ï¼š<span id="scoreVal">0</span> pt</div>
        </div>
        <div class="progress-bg"><div id="rankProgress" class="progress-bar"></div></div>
        <div class="rank-footer">
            <span id="rankNext">ä¸‹ä¸€ç´šé‚„å·® 1000 åˆ†</span>
            <span>æ ¸å‡†ç¾é‡‘åŠ ç¢¼ä¸­</span>
        </div>
    </div>

    <h2 style="text-align:center; color:#1a508b;">æ­£å¼è²¸æ¬¾ç”³è«‹è¡¨å–®</h2>

    <div class="sec">ä¸€ã€ç”³è«‹é …ç›®</div>
    <div class="g">
        <label>æ¬²ç”³è«‹æ–¹æ¡ˆ</label>
        <select id="v32">
            <option value="å•†å“åˆ†æœŸ">å•†å“åˆ†æœŸ (æ©Ÿè»Š/æ‰‹æ©Ÿ/å®¶é›»)</option>
            <option value="æ©Ÿè»Šè²¸">æ©Ÿè»Šè²¸ (åŸè»Šèè³‡)</option>
            <option value="æ±½è»Šè²¸">æ±½è»Šè²¸ (åŸè»Šèè³‡)</option>
            <option value="å€‹äººä¿¡è²¸">å€‹äººå°é¡ä¿¡è²¸</option>
        </select>
    </div>

    <div class="sec">äºŒã€å€‹äººè³‡æ–™</div>
    <div class="g"><label>å…¨å</label><input type="text" id="v1" placeholder="ä¾‹ï¼šé™³å°æ˜"></div>
    <div class="g"><label>LINE ID</label><input type="text" id="v2" placeholder="ä¾‹ï¼šabc1234"></div>
    <div class="g"><label>å‡ºç”Ÿå¹´æœˆæ—¥</label><input type="text" id="v3" placeholder="ä¾‹ï¼š80/01/01"></div>
    <div class="g"><label>èº«åˆ†è­‰å­—è™Ÿ</label><input type="text" id="v4" placeholder="ä¾‹ï¼šA123456789"></div>
    <div class="g"><label>æœ€é«˜å­¸æ­·</label><input type="text" id="v5" placeholder="ä¾‹ï¼šå¤§å­¸"></div>
    <div class="g"><label>æ‰‹æ©Ÿè™Ÿç¢¼</label><input type="tel" id="v6" placeholder="ä¾‹ï¼š0912345678"></div>
    <div class="g"><label>æ–¹ä¾¿è¯çµ¡æ™‚é–“</label><input type="text" id="v7" placeholder="ä¾‹ï¼šå¹³æ—¥æ™šä¸Š"></div>
    <div class="g"><label>é›»ä¿¡æ¥­è€…</label><input type="text" id="v8" placeholder="ä¾‹ï¼šä¸­è¯é›»ä¿¡"></div>
    <div class="g"><label>å¸¸ç”¨ Email</label><input type="email" id="v9" placeholder="ä¾‹ï¼štest@mail.com"></div>

    <div class="sec">ä¸‰ã€å±…ä½èˆ‡å·¥ä½œ</div>
    <div class="g"><label>æˆ¶ç±åœ°å€</label><input type="text" id="v10"></div>
    <div class="g"><label>æˆ¶ç±é›»è©±</label><input type="text" id="v11"></div>
    <div class="g"><label>ç¾å±…åœ°å€</label><input type="text" id="v12"></div>
    <div class="g"><label>ç¾å±…é›»è©±</label><input type="text" id="v13"></div>
    <div class="g"><label>å±…ä½æ™‚é–“</label><input type="text" id="v14"></div>
    <div class="g"><label>å±…ä½ç‹€æ³</label><select id="v15"><option value="è‡ªæœ‰">è‡ªæœ‰</option><option value="ç§Ÿè³ƒ">ç§Ÿè³ƒ</option><option value="è¦ªå‹">è¦ªå‹</option></select></div>
    <div class="g"><label>å…¬å¸åç¨±</label><input type="text" id="v16"></div>
    <div class="g"><label>å…¬å¸é›»è©±</label><input type="text" id="v17"></div>
    <div class="g"><label>å…¬å¸åœ°å€</label><input type="text" id="v18"></div>
    <div class="g"><label>è·ç¨±</label><input type="text" id="v19"></div>
    <div class="g"><label>æœˆæ”¶å…¥</label><input type="text" id="v20"></div>
    <div class="g"><label>å¹´è³‡</label><input type="text" id="v21"></div>
    <div class="g"><label>æœ‰ç„¡å‹ä¿è–ªè½‰</label><input type="text" id="v22"></div>

    <div class="sec">å››ã€è¯çµ¡äººè³‡è¨Š</div>
    <div class="g"><label>è¯çµ¡äºº1å§“å</label><input type="text" id="v23"></div>
    <div class="g"><label>è¯çµ¡äºº1é—œä¿‚</label><input type="text" id="v24"></div>
    <div class="g"><label>è¯çµ¡äºº1é›»è©±</label><input type="tel" id="v25"></div>
    <div class="g"><label>æ–¹ä¾¿ç…§æœƒæ™‚é–“</label><input type="text" id="v26"></div>
    <div class="g"><label>è¯çµ¡äºº2å§“å</label><input type="text" id="v27"></div>
    <div class="g"><label>è¯çµ¡äºº2é—œä¿‚</label><input type="text" id="v28"></div>
    <div class="g"><label>è¯çµ¡äºº2é›»è©±</label><input type="tel" id="v29"></div>
    <div class="g"><label>æ–¹ä¾¿ç…§æœƒæ™‚é–“</label><input type="text" id="v30"></div>

    <div class="sec">äº”ã€ç­‰ç´šæ™‰å‡èˆ‡æ¨è–¦çé‡‘</div>
    <div class="promo-box">
        <b>â­ ç•¶å‰ç­‰ç´šå›é¥‹èªªæ˜ï¼š</b><br>
        <span id="rewardText">è¼‰å…¥ä¸­...</span><br>
        <small>â€» æ¯æ—¥ç°½åˆ° +5 åˆ†ï¼Œè‡ªå·±è¾¦ +200 åˆ†ï¼Œæ¨è–¦æ ¸å‡† +500 åˆ†ï¼</small>
    </div>
    <div class="g"><label>æ¨è–¦äººå§“å</label><input type="text" id="v31" placeholder="ç„¡å‰‡å¡«ç„¡"></div>
    <div class="g"><label>æ¨è–¦äººé›»è©±</label><input type="tel" id="v33" placeholder="ç„¡å‰‡å¡«ç„¡"></div>

    <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="finishAction()">
    <button id="submitBtn" class="btn" onclick="handleSubmit()">ç¢ºèªé€å‡ºä¸¦é ˜å–ç©åˆ†</button>
</div>

<script>
    const LIFF_ID = "2008759894-DkxBFgJp"; 
    let score = parseInt(localStorage.getItem('user_loan_score')) || 0;

    liff.init({ liffId: LIFF_ID }).then(() => {
        if (!liff.isLoggedIn()) liff.login();
        handleDailyCheck();
        updateDisplay();
    });

    function handleDailyCheck() {
        const today = new Date().toLocaleDateString();
        if (localStorage.getItem('last_check') !== today) {
            score += 5;
            localStorage.setItem('user_loan_score', score);
            localStorage.setItem('last_check', today);
            alert("ğŸ“… ä»Šæ—¥ç°½åˆ°æˆåŠŸï¼ç©åˆ† +5 pt");
        }
    }

    function updateDisplay() {
        let rank = "é’éŠ…æœƒå“¡", next = 1000 - score, percent = (score/1000)*100, reward = "æ¨è–¦é ˜ $1,000 / è‡ªå·±è¾¦é ˜ $500";
        if (score >= 3000) { rank="é‘½çŸ³æœƒå“¡"; percent=100; next=0; reward="æ¨è–¦é ˜ $1,500 / è‡ªå·±è¾¦é ˜ $1,000"; }
        else if (score >= 1000) { rank="ç™½é‡‘æœƒå“¡"; percent=((score-1000)/2000)*100; next=3000-score; reward="æ¨è–¦é ˜ $1,200 / è‡ªå·±è¾¦é ˜ $800"; }
        
        document.getElementById('rankLabel').innerText = rank;
        document.getElementById('scoreVal').innerText = score;
        document.getElementById('rankProgress').style.width = percent + "%";
        document.getElementById('rankNext').innerText = next > 0 ? "è·é›¢ä¸‹ä¸€ç´šé‚„å·® " + next + " åˆ†" : "å·²é”æœ€é«˜ç­‰ç´š";
        document.getElementById('rewardText').innerText = "å›é¥‹é‡‘ï¼š " + reward;
    }

    async function handleSubmit() {
        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        btn.innerText = "è³‡æ–™è™•ç†ä¸­...";

        let msg = `ã€æ–°ä»¶ç”³è«‹ã€‘\nç­‰ç´šï¼š${document.getElementById('rankLabel').innerText}\n`;
        const ids = ['v32','v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v14','v15','v16','v17','v18','v19','v20','v21','v22','v23','v24','v25','v26','v27','v28','v29','v30','v31','v33'];
        ids.forEach(id => {
            const el = document.getElementById(id);
            if(el) msg += `${el.previousElementSibling.innerText}ï¼š${el.value || 'ç„¡'}\n`;
        });

        try {
            await liff.sendMessages([{ type: 'text', text: msg }]);
            score += 200; // è‡ªå·±è¾¦æˆåŠŸåŠ 200åˆ†
            localStorage.setItem('user_loan_score', score);
            document.getElementById('photoInput').click();
        } catch (e) { alert("å‚³é€å¤±æ•—"); btn.disabled = false; }
    }

    function finishAction() {
        alert("ğŸ‰ ç”³è«‹å·²é€å‡ºï¼ç©åˆ†å·²åŒæ­¥æ›´æ–°ã€‚æ ¸å‡†å¾Œå°‡ä¾ç­‰ç´šç™¼æ”¾å›é¥‹é‡‘ï¼");
        liff.closeWindow();
    }
</script>
</body>
</html>